# 🍕 Total Revenue Analysis — Pizza Sales Database

## Objective:
Analyze total revenue generated by the pizza store, breaking it down by pizza types, sizes, categories, and orders to derive actionable business insights.

---

## Query 1: Total Revenue (Overall)

Calculate total revenue by summing the product of pizza price and quantity sold.

```sql
SELECT 
    ROUND(SUM(od.quantity * p.price), 2) AS total_revenue
FROM 
    order_details od
JOIN 
    pizza p ON od.pizza_id = p.pizza_id;
```

### 💰 Total Revenue
**₹817,860.05** — This is the grand total revenue generated from all pizza orders.


---

## Query 2: Revenue by Pizza Type

Identify revenue contribution from each pizza type.

``` sql
SELECT 
    pt.name AS pizza_name,
    ROUND(SUM(od.quantity * p.price), 2) AS revenue
FROM 
    order_details od
JOIN 
    pizza p ON od.pizza_id = p.pizza_id
JOIN 
    pizza_types pt ON p.pizza_type_id = pt.pizza_type_id
GROUP BY 
    pt.name
ORDER BY 
    revenue DESC;
```

### 🏆 Top 10 Best-Selling Pizzas by Revenue

| Rank | Pizza Name                   | Revenue (₹) |
|------|------------------------------|-------------|
| 1    | The Thai Chicken Pizza       | 43,434.25   |
| 2    | The Barbecue Chicken Pizza   | 42,768.00   |
| 3    | The California Chicken Pizza | 41,409.50   |
| 4    | The Classic Deluxe Pizza     | 38,180.50   |
| 5    | The Spicy Italian Pizza      | 34,831.25   |
| 6    | The Southwest Chicken Pizza  | 34,705.75   |
| 7    | The Italian Supreme Pizza    | 33,476.75   |
| 8    | The Hawaiian Pizza           | 32,273.25   |
| 9    | The Four Cheese Pizza        | 32,265.70   |
| 10   | The Sicilian Pizza           | 30,940.50   |

---

## Query 3: Revenue by Pizza Size

Determine which pizza size drives the most revenue.

```sql
SELECT 
    p.size,
    ROUND(SUM(od.quantity * p.price), 2) AS revenue
FROM 
    order_details od
JOIN 
    pizza p ON od.pizza_id = p.pizza_id
GROUP BY 
    p.size
ORDER BY 
    revenue DESC;
```

### 🍕 Revenue by Pizza Size

| Size | Revenue (₹) | Share (%) |
|------|-------------|-----------|
| L    | 375,318.70  | 45.9%     |
| M    | 249,382.25  | 30.5%     |
| S    | 178,076.50  | 21.8%     |
| XL   | 14,076.00   | 1.7%      |
| XXL  | 1,006.60    | 0.1%      |

> 🔍 **Insight**: Large pizzas dominate revenue, contributing nearly **46%** alone.


---

## Query 4: Revenue by Category

Analyze revenue for each pizza category like Classic, Chicken, Veggie.

```sql
SELECT 
    pt.category,
    ROUND(SUM(od.quantity * p.price), 2) AS revenue
FROM 
    order_details od
JOIN 
    pizza p ON od.pizza_id = p.pizza_id
JOIN 
    pizza_types pt ON p.pizza_type_id = pt.pizza_type_id
GROUP BY 
    pt.category
ORDER BY 
    revenue DESC;
```

### 📂 Revenue by Pizza Category

| Category | Revenue (₹)  | Share (%) |
|----------|--------------|-----------|
| Classic  | 220,053.10   | 26.9%     |
| Supreme  | 208,197.00   | 25.5%     |
| Chicken  | 195,919.50   | 24.0%     |
| Veggie   | 193,690.45   | 23.6%     |

> 📌 All categories are fairly balanced in revenue share, each hovering around 24–27%.

---

## Query 5: Top 10 Revenue-Generating Pizzas

List specific pizza SKUs earning the highest revenue.

```sql
SELECT 
    od.pizza_id,
    ROUND(SUM(od.quantity * p.price), 2) AS revenue
FROM 
    order_details od
JOIN 
    pizza p ON od.pizza_id = p.pizza_id
GROUP BY 
    od.pizza_id
ORDER BY 
    revenue DESC
LIMIT 10;
```
### 🥇 Top 10 Highest Revenue Pizzas by ID

| Rank | Pizza ID       | Revenue (₹) |
|------|----------------|-------------|
| 1    | thai_ckn_l     | 29,257.50   |
| 2    | five_cheese_l  | 26,066.50   |
| 3    | four_cheese_l  | 23,622.20   |
| 4    | spicy_ital_l   | 23,011.75   |
| 5    | big_meat_s     | 22,968.00   |
| 6    | southw_ckn_l   | 21,082.00   |
| 7    | bbq_ckn_l      | 20,584.00   |
| 8    | cali_ckn_l     | 19,235.25   |
| 9    | classic_dlx_m  | 18,896.00   |
| 10   | mexicana_l     | 17,556.75   |



---

## Query 6: Top 10 Orders by Revenue

Find the highest revenue-generating customer orders.

```sql
SELECT 
    od.order_id,
    ROUND(SUM(od.quantity * p.price), 2) AS order_revenue
FROM 
    order_details od
JOIN 
    pizza p ON od.pizza_id = p.pizza_id
GROUP BY 
    od.order_id
ORDER BY 
    order_revenue DESC
LIMIT 10;
```
### 🧾 Top 10 Orders by Revenue

| Order ID | Order Revenue (₹) |
|----------|-------------------|
| 18845    | 444.20            |
| 10760    | 417.15            |
| 1096     | 285.15            |
| 6169     | 284.00            |
| 740      | 280.95            |
| 12257    | 276.75            |
| 1685     | 272.75            |
| 4482     | 267.20            |
| 5452     | 267.10            |
| 16786    | 265.55            |

---

## Query 7: Revenue by Pizza Type and Size (Using CTE)

Analyze the most profitable pizza type-size combinations.

```sql
WITH revenue_cte AS (
    SELECT 
        pt.name AS pizza_name,
        p.size,
        ROUND(SUM(od.quantity * p.price), 2) AS revenue
    FROM 
        order_details od
    JOIN 
        pizza p ON od.pizza_id = p.pizza_id
    JOIN 
        pizza_types pt ON p.pizza_type_id = pt.pizza_type_id
    GROUP BY 
        pt.name, p.size
)
SELECT *
FROM revenue_cte
ORDER BY revenue DESC
LIMIT 15;
```
### 🔍 Revenue Breakdown by Pizza & Size

| Pizza Name                     | Size | Revenue (₹) |
|--------------------------------|------|-------------|
| The Thai Chicken Pizza         | L    | 29,257.50   |
| The Five Cheese Pizza          | L    | 26,066.50   |
| The Four Cheese Pizza          | L    | 23,622.20   |
| The Spicy Italian Pizza        | L    | 23,011.75   |
| The Big Meat Pizza             | S    | 22,968.00   |
| The Southwest Chicken Pizza    | L    | 21,082.00   |
| The Barbecue Chicken Pizza     | L    | 20,584.00   |
| The California Chicken Pizza   | L    | 19,235.25   |
| The Classic Deluxe Pizza       | M    | 18,896.00   |
| The Mexicana Pizza             | L    | 17,556.75   |

---

## Query 8: Ranked Revenue by Pizza (Using Window Function)

Rank pizzas by revenue using RANK() window function for detailed leaderboard.

```sql
SELECT 
    pt.name AS pizza_name,
    ROUND(SUM(od.quantity * p.price), 2) AS revenue,
    RANK() OVER (ORDER BY SUM(od.quantity * p.price) DESC) AS revenue_rank
FROM 
    order_details od
JOIN 
    pizza p ON od.pizza_id = p.pizza_id
JOIN 
    pizza_types pt ON p.pizza_type_id = pt.pizza_type_id
GROUP BY 
    pt.name;
```

### 📊 Ranked Revenue Insights — Pizza Performance by Name

This analysis ranks all pizzas by their total revenue contribution, providing a clear leaderboard of top sellers.

### 🥇 Top 5 Revenue-Generating Pizzas:

| Rank | Pizza Name                  | Revenue (₹) |
|------|-----------------------------|--------------|
| 1    | The Thai Chicken Pizza      | ₹43,434.25   |
| 2    | The Barbecue Chicken Pizza  | ₹42,768.00   |
| 3    | The California Chicken Pizza| ₹41,409.50   |
| 4    | The Classic Deluxe Pizza    | ₹38,180.50   |
| 5    | The Spicy Italian Pizza     | ₹34,831.25   |

- These 5 pizzas alone contribute **~24%** of the total revenue.
- All of them are either **chicken-based or rich in bold flavors**, indicating strong customer preference.

### 📈 Mid-Tier Pizzas (Rank 6–20):

- Includes **Italian Supreme, Hawaiian, Four Cheese, Pepperoni, and Greek**.
- These pizzas offer a balanced mix across **Chicken, Classic, and Veggie** categories.
- Revenue ranges from **₹32,000 to ₹23,000**, showing consistency in demand.

### 🧊 Bottom-Tier Performers (Rank 21–32):

| Rank | Pizza Name                    | Revenue (₹) |
|------|-------------------------------|-------------|
| 21   | The Big Meat Pizza            | ₹22,968.00  |
| 32   | The Brie Carre Pizza          | ₹11,588.50  |

- The bottom 12 pizzas generate less than **15%** of total revenue combined.
- These include more **niche flavors** or **less popular combinations** (e.g., Brie Carre, Green Garden).
- Important to evaluate:
  - Is low revenue due to low demand or lack of visibility?
  - Could bundling, promotions, or repositioning help?

### 🧠 Strategic Insights:

- 🔥 **Focus on top 10 pizzas** for promotions, combo offers, and upsells.
- 🧪 **Reevaluate bottom 5** pizzas (Green Garden, Spinach Supreme, Brie Carre) for possible:
  - Menu optimization
  - Marketing tweaks
  - Seasonal or limited-edition rebranding
- 📊 Integrate ranking into dashboards to monitor shifts in performance over time.

> 🧭 This ranked analysis is vital for understanding where to allocate marketing, kitchen prep focus, and inventory costs.

---


## 🧠 Key Insights — Total Revenue Analysis

- 💰 **Total Revenue:** The business has generated a total revenue of **₹817,860.05** from all pizza sales.

- 🥇 **Top Pizza by Revenue:**  
  **The Thai Chicken Pizza** is the highest revenue-generating pizza at ₹43,434.25, dominating both in volume and value.

- 🍕 **Pizza Size Matters:**  
  - **Large (L) pizzas** account for the majority of sales, contributing nearly **46%** of total revenue.  
  - This suggests that customers prefer larger portions, which also bring higher per-unit revenue.

- 🧾 **Pizza Category Breakdown:**  
  - Revenue is fairly balanced across all categories:
    - **Classic:** 26.9%
    - **Supreme:** 25.5%
    - **Chicken:** 24.0%
    - **Veggie:** 23.6%
  - This indicates a healthy product mix, with no single category overly dominant.

- 📦 **Top Revenue-Generating Pizza IDs:**  
  - The **thai_ckn_l** (Large Thai Chicken Pizza) alone brought in **₹29,257.50**.  
  - **Five Cheese** and **Four Cheese (L)** variants also performed exceptionally well, showing strong customer preference for cheese-heavy options.

- 🧾 **High-Value Orders:**  
  - The highest individual order brought in **₹444.20**.  
  - Top 10 orders are all above ₹265, indicating a solid portion of high-ticket purchases.

- 🔍 **Strategic Opportunities:**
  - Promote high-performing **L-size** pizzas more actively (combo offers, upselling from M to L).
  - Consider bundling popular pizzas like **Thai Chicken, Barbecue Chicken, and Four Cheese** in premium packages.
  - Analyze top orders for patterns (time, day, combos) to replicate success.

> 📌 This foundational revenue analysis will inform pricing, promotion, inventory, and product strategy in later reports.

---